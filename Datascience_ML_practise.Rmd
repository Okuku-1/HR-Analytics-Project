---
title: "Data Science & ML Practice Questions"
author: "Eddy Okuku"
date: "2025-08-28"
output:
  word_document: default
  html_document: default
---

```{r}
#working directory
setwd("C:/Users/Public/ML")
```

## üìä Dataset Overview

- **Rows (observations):** 311 employees  
- **Columns (features):** 36 attributes  
- **File name:** `HRDataset_v14.csv`  
- **Type:** HR / Employee dataset  

---

## üîë Key Columns

### üë§ Employee Information
- `Employee_Name`, `EmpID`  
- `DOB`, `Sex`, `MaritalDesc`, `CitizenDesc`, `RaceDesc`, `HispanicLatino`  

### üè¢ Employment Details
- `DateofHire`, `DateofTermination`, `TermReason`  
- `EmploymentStatus`, `Department`, `Position`, `ManagerName`, `ManagerID`  
- `RecruitmentSource`  

### üìà Performance & Engagement
- `PerfScoreID`, `PerformanceScore`  
- `LastPerformanceReview_Date`  
- `EngagementSurvey` (numeric score)  
- `EmpSatisfaction` (numeric 1‚Äì5 scale)  
- `SpecialProjectsCount`  
- `DaysLateLast30`, `Absences`  

### üí∞ Compensation
- `Salary`  

### üî¢ Identifiers & Categorical Codes
- `MarriedID`, `MaritalStatusID`, `GenderID`, `EmpStatusID`, `DeptID`, `PositionID`  

---

## ‚ö†Ô∏è Notes
- Some columns are **redundant** (e.g., `MarriedID` vs. `MaritalDesc`, `GenderID` vs. `Sex`).  
- `DateofTermination` has many missing values (only 104/311 employees terminated).  
- The dataset contains a **mixture of numeric, categorical, and date columns**, making it suitable for both **descriptive analytics** and **predictive modeling**.  


```{r}
#Load packages
library(tidyverse)
library(readxl)
```

## Part A: Basic EDA (Exploratory Data Analysis)
### 1. Load the dataset into a Pandas DataFrame and display the first 5 rows.


```{r}
#load packages
hr <- read_csv("HRDataset_v14.csv")
head(hr)
```
### 2.Check the shape of the dataset (rows, columns).
```{r}
dim(hr)
```
 
### 3. Display the column names and their data types.
```{r}
#column names and data types
str(hr)
```
```{r}
#option 2
library(tibble)

col_classes <- sapply(hr, class)

#format into a clean tibble
col_info <- tibble(
  Column = names(col_classes),
  Data_Type = as.character(col_classes)
)

col_info
```
## 4. Find the number of unique values in each column.
```{r}
#number of unique values per column
unique_counts <- sapply(hr, n_distinct)

#Display as a data frame
data.frame(
  Column = names(unique_counts),
  Unique_Values = as.vector(unique_counts)
)
```

## 5. Identify missing values in the dataset and list columns with nulls.
```{r}
#Listing columns with missing
colSums(is.na(hr))
```

## Describe the numerical columns (mean, median, std).
```{r}
library(dplyr)
library(tidyr)

# Summarize numeric columns (mean, median, std dev)
numeric_summary <- hr %>%
  select(where(is.numeric)) %>%
  summarise(across(everything(),
                   list(
                     Mean = ~mean(., na.rm = TRUE),
                     Median = ~median(., na.rm = TRUE),
                     StdDev = ~sd(., na.rm = TRUE)
                   ),
                   .names = "{.col}_{.fn}"))

# Reshape into a tidy table
numeric_summary <- numeric_summary %>%
  pivot_longer(cols = everything(),
               names_to = c("Column", "Statistic"),
               names_sep = "_") %>%
  pivot_wider(names_from = Statistic, values_from = value)

numeric_summary

```

## 7. Find the distribution of employee salaries.
```{r}
#distribution of employee salary using histogram
ggplot(hr, aes(Salary)) +
  geom_histogram(binwidth = 5000, fill = "steelblue", color = "black", alpha = 0.7) + 
  labs(title = "Distribution of Employee Salaries",
       x = "Salary",
       y = "Count") +
  theme_minimal()
```

## 8. What is the average age of employees at the company? (Use DOB column).
```{r}
library(lubridate)

#converting DOB to date type
hr$DOB <- mdy(hr$DOB)

#calculating age
hr$Age <- as.numeric(difftime(Sys.Date(), hr$DOB, units = "days"))/ 365.25

#average employee age
mean(hr$Age, na.rm=TRUE)
```

## 9. How many employees are still employed vs terminated?
```{r}
#0: Still employed, 1: terminated
emp_status <- hr %>% 
  group_by(Termd) %>% 
  summarise(Count = n())

emp_status

#Bar plot of Employed vs Terminated
ggplot(emp_status, aes(x = factor(Termd), y = Count, fill = factor(Termd))) +
  geom_bar(stat = "identity", width = 0.6) +
  scale_x_discrete(labels = c("0" = "Employed", "1" = "Terminated")) +
  labs(title = "Employees: Employed vs Terminated",
       x = "Status",
       y = "Number of Employees",
       fill = "Termd") +
  theme_minimal()
```

## 10. Which departments have the most employees?
```{r}
dept_emp <- hr %>% 
  group_by(Department) %>% 
  summarise(Employees = n()) %>% 
  arrange(desc(Employees))

dept_emp

# Bar plot of employees by department
ggplot(dept_emp, aes(x = reorder(Department, -Employees), y = Employees, fill = Department)) +
  geom_bar(stat = "identity") +
  labs(title = "Number of Employees by Department",
       x = "Department",
       y = "Number of Employees") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

# Part B: Business Analysis
## 11. What is the average salary per department?
```{r}
avg_salary_dept <- hr %>% 
  group_by(Department) %>% 
  summarise(average_salary = mean(Salary, na.rm= TRUE)) %>% 
  arrange(desc(average_salary))


avg_salary_dept
```

## 12. Find the distribution of employment status (Active, Voluntarily Terminated, etc.).
```{r}
status_count <- hr %>% 
  group_by(EmploymentStatus) %>% 
  summarize(Count = n()) %>% 
  arrange(desc(Count))

status_count


# Bar plot of Employment Status distribution
ggplot(status_count, aes(x= reorder(EmploymentStatus, -Count), y= Count, 
                         fill= EmploymentStatus)) +
  geom_bar(stat = "identity") +
  labs(title = "Distribution of Empployment Status",
       x= "Employment Status",
       y= "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle= 45, hjust = 1))
```

## 13. Compare salary levels between Male and Female employees.
```{r}
salary_gender <- hr %>% 
  group_by(Sex) %>% 
  summarise(avg_salary = mean(Salary, na.rm= TRUE),
            Mediam_salary = median(Salary, na.rm= TRUE),
            Count = n())
        

salary_gender

# Boxplot comparison
ggplot(hr, aes(x= Sex, y= Salary, fill = Sex)) +
  geom_boxplot(alpha = 0.7) +
  labs(title = "Salary Distribution by Gender",
       x = "Gender",
       y = "Salary") +
  theme_minimal()

# Violin plot for more detail.
ggplot(hr, aes(x = Sex, y = Salary, fill = Sex)) +
  geom_violin(trim = FALSE, alpha = 0.6) +
  geom_boxplot(width = 0.1, fill = "white") +
  labs(title = "Salary Levels by Gender",
       x = "Gender",
       y = "Salary") +
  theme_minimal()
```

## 14. Which recruitment source brings in the most employees?
```{r}
rec_count <- hr %>% 
  group_by(RecruitmentSource) %>% 
  summarise(Count = n()) %>% 
  arrange(desc(Count))

rec_count

```

## 15. What percentage of employees attended a Diversity Job Fair?
```{r}
diversity_attendance <- hr %>% 
  group_by(FromDiversityJobFairID) %>% 
  summarise(Count = n()) %>% 
  mutate(Percentage = round(100 * Count / sum(Count), 2))

diversity_attendance
  
```

## 16. Compare engagement survey scores across different departments.
```{r}
engagement_dept <- hr %>%
  group_by(Department) %>%
  summarise(
    Avg_Engagement = mean(EngagementSurvey, na.rm = TRUE),
    Median_Engagement = median(EngagementSurvey, na.rm = TRUE),
    Count = n()
  ) %>%
  arrange(desc(Avg_Engagement))

engagement_dept
```

## 17. Which race has the highest average salary?
```{r}
race_salary <- hr %>% 
  group_by(RaceDesc) %>% 
  summarize(avg_salary = mean(Salary, na.rm= TRUE)) %>% 
  arrange(desc(avg_salary))

race_salary
```

## 18. What is the relationship between number of projects (SpecialProjectsCount) and salary
```{r}
library(pander)
#correlation test
pander(cor.test(hr$SpecialProjectsCount, hr$Salary, use = "compete.obs"))

#scatter plot visualization
ggplot(hr, aes(x= SpecialProjectsCount, y = Salary)) +
  geom_point(alpha= 0.6) +
  geom_smooth(method = "lm", se = TRUE, color= "blue") +
  labs(title = "Relationship between Special Projects and Salary",
       x = "Number of Special Projects",
       y = "Salary")
```

## 19. Do married employees earn more on average than single employees?
```{r}
employee_status <- hr %>% 
  group_by(MaritalDesc) %>% 
  summarize(avg_salary = mean(Salary, na.rm= TRUE),
            count = n()) %>% 
  arrange(desc(avg_salary))

employee_status

# Statistical test: Married vs Single
pander(t.test(Salary ~ MaritalDesc, data = hr %>% 
         filter(MaritalDesc %in% c("Married", "Single"))))
```

## 20. Which managers have the largest teams?
```{r}
manager_team <- hr %>% 
  group_by(ManagerName) %>% 
  summarise(team_size = n()) %>% 
  arrange(desc(team_size))

manager_team
```

# Part C: Data Visualization
## 21. Plot the salary distribution using histograms.
```{r}
# Histogram of Salary
ggplot(hr, aes(x = Salary)) +
  geom_histogram(binwidth = 5000, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Salary Distribution",
       x = "Salary",
       y = "Number of Employees") +
  theme_minimal()
```

## 22. Show the count of employees by department.
```{r}
# Count employees by department
dept_counts <- hr %>%
  group_by(Department) %>%
  summarise(employee_count = n()) %>%
  arrange(desc(employee_count))

dept_counts

ggplot(dept_counts, aes(x = reorder(Department, -employee_count), y = employee_count)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(title = "Number of Employees by Department",
       x = "Department",
       y = "Employee Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## 23. Compare average satisfaction score by department
```{r}
# Average satisfaction by department
dept_satisfaction <- hr %>%
  group_by(Department) %>%
  summarise(avg_satisfaction = mean(EmpSatisfaction, na.rm = TRUE),
            count = n()) %>%
  arrange(desc(avg_satisfaction))

dept_satisfaction

ggplot(dept_satisfaction, aes(x = reorder(Department, -avg_satisfaction), y = avg_satisfaction)) +
  geom_bar(stat = "identity", fill = "seagreen", alpha = 0.8) +
  labs(title = "Average Employee Satisfaction by Department",
       x = "Department",
       y = "Average Satisfaction (1‚Äì5)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

## 24. Visualize employee terminations over time.
```{r}
# Convert to proper date format
hr$DateofTermination <- as.Date(hr$DateofTermination, format = "%m/%d/%Y")

# Filter out employees still employed (NA termination date)
term_data <- hr %>%
  filter(!is.na(DateofTermination)) %>%
  mutate(term_year = year(DateofTermination)) %>%
  group_by(term_year) %>%
  summarise(terminations = n()) %>%
  arrange(term_year)

term_data

ggplot(term_data, aes(x = term_year, y = terminations)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "darkred", size = 2) +
  labs(title = "Employee Terminations Over Time",
       x = "Year",
       y = "Number of Terminations") +
  theme_minimal()

```

## 25. Plot average salary by gender using a boxplot.
```{r}
# Boxplot of Salary by Gender
ggplot(hr, aes(x = Sex, y = Salary, fill = Sex)) +
  geom_boxplot(alpha = 0.7) +
  labs(title = "Salary Distribution by Gender",
       x = "Gender",
       y = "Salary") +
  theme_minimal() +
  theme(legend.position = "none")
```

## 26. Visualize performance scores vs salary.
```{r}
# Boxplot of Salary by Performance Score
ggplot(hr, aes(x = PerformanceScore, y = Salary, fill = PerformanceScore)) +
  geom_boxplot(alpha = 0.7) +
  labs(title = "Salary Distribution by Performance Score",
       x = "Performance Score",
       y = "Salary") +
  theme_minimal() +
  theme(legend.position = "none")
```

## 27. Create a heatmap of correlations between numeric variables.
```{r}
library(reshape2)

# Select numeric columns
numeric_data <- hr %>% select(where(is.numeric))

# Compute correlation matrix
corr_matrix <- cor(numeric_data, use = "complete.obs")

# Reshape for ggplot
melted_corr <- melt(corr_matrix)

# Heatmap
ggplot(melted_corr, aes(x = Var1, y = Var2, fill = value)) +
  geom_tile(color = "white") +
  scale_fill_gradient2(low = "red", high = "blue", mid = "white",
                       midpoint = 0, limit = c(-1, 1), space = "Lab",
                       name = "Correlation") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
  labs(title = "Correlation Heatmap of Numeric Variables",
       x = "",
       y = "")
```

## 28. Plot engagement survey score vs satisfaction score.
```{r}
# Scatter plot of Engagement vs Satisfaction
ggplot(hr, aes(x = EngagementSurvey, y = EmpSatisfaction)) +
  geom_point(alpha = 0.6, color = "steelblue") +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  labs(title = "Engagement Survey Score vs Employee Satisfaction",
       x = "Engagement Survey Score",
       y = "Employee Satisfaction (1‚Äì5)") +
  theme_minimal()

pander(cor.test(hr$EngagementSurvey, hr$EmpSatisfaction, use = "complete.obs"))
```

## Show a stacked bar chart of employee status across departments.
```{r}
# Stacked bar chart: Employment Status by Department
ggplot(hr, aes(x = Department, fill = EmploymentStatus)) +
  geom_bar(position = "stack") +
  labs(title = "Employee Status Across Departments",
       x = "Department",
       y = "Number of Employees",
       fill = "Employment Status") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## 30. Plot absenteeism (Absences) distribution among employees
```{r}
ggplot(hr, aes(x = Absences)) +
  geom_histogram(binwidth = 1, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Employee Absences",
       x = "Number of Absences",
       y = "Count of Employees") +
  theme_minimal()
```

# Part D: PCA (Dimensionality Reduction)
## 31. Standardize numerical features before applying PCA.
```{r}
# 1. selecting numerical variables
numeric_data <- hr %>% 
  select(where(is.numeric))

# 2. Remove rows with NA or Inf values
numeric_clean <- numeric_data %>%
  filter(if_all(everything(), ~ !is.na(.) & is.finite(.)))

# 3. Standardize (center and scale)
numeric_scaled <- scale(numeric_clean)

# 4. Run PCA
pca_result <- prcomp(numeric_scaled, center= TRUE, scale. = TRUE)

# 5. Summary of PCA
summary(pca_result)

# 5. Scree plot (explained variance per component)
plot(pca_result, type = "barplot", main = "Scree Plot")

# 6. Biplot (visualize first 2 components)
biplot(pca_result, scale = 0)

```

## Perform PCA on the dataset and explain the first 2 components.
```{r}
# Loadings of the first 2 PCs
loadings <- pca_result$rotation[, 1:2]
loadings

```

## 33. Plot the explained variance ratio for the PCA components.
```{r}
# Compute variance explained
explained_var <- pca_result$sdev^2 / sum(pca_result$sdev^2)
explained_df <- data.frame(
  PC = paste0("PC", 1:length(explained_var)),
  Variance = explained_var,
  Cumulative = cumsum(explained_var)
)

# Scree plot
ggplot(explained_df, aes(x = PC, y = Variance)) +
  geom_bar(stat = "identity", fill = "steelblue", alpha = 0.7) +
  geom_line(aes(y = Cumulative, group = 1), color = "red", size = 1) +
  geom_point(aes(y = Cumulative), color = "red", size = 2) +
  labs(title = "Explained Variance Ratio of PCA Components",
       x = "Principal Component",
       y = "Variance Explained") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## 34. Reduce the dataset to 2 dimensions with PCA and plot employees colored by department.
```{r}
# Select numeric features
numeric_data <- hr %>% select(where(is.numeric))

# Keep only complete rows
numeric_clean <- numeric_data %>% filter(if_all(everything(), ~ !is.na(.) & is.finite(.)))

# Standardize
numeric_scaled <- scale(numeric_clean)

# Run PCA
pca_result <- prcomp(numeric_scaled, center = TRUE, scale. = TRUE)

# Get the corresponding Department info for rows used
departments_clean <- hr %>% filter(if_all(where(is.numeric), ~ !is.na(.) & is.finite(.))) %>% 
  pull(Department)

# Get PCA scores for first 2 PCs
pc_scores <- as.data.frame(pca_result$x[, 1:2])
colnames(pc_scores) <- c("PC1", "PC2")
pc_scores$Department <- departments_clean

# Plot
library(ggplot2)

ggplot(pc_scores, aes(x = PC1, y = PC2, color = Department)) +
  geom_point(alpha = 0.7, size = 2) +
  labs(title = "PCA: Employees in 2D Space by Department",
       x = "PC1",
       y = "PC2",
       color = "Department") +
  theme_minimal()

```

## 35. Which variables contribute most to the first principal component?
```{r}
# Loadings for PC1
pc1_loadings <- pca_result$rotation[, 1]

# Sort by absolute contribution
pc1_contrib <- sort(abs(pc1_loadings), decreasing = TRUE)
pander(pc1_contrib)

```

## 36. Apply PCA to engagement + satisfaction + absences. Do these condense into 1 dimension?
```{r}
#Step 1
# Select only the 3 variables
subset_data <- hr %>% select(EngagementSurvey, EmpSatisfaction, Absences)

# Remove rows with NA or Inf
subset_clean <- subset_data %>% filter(if_all(everything(), ~ !is.na(.) & is.finite(.)))

# Standardize
subset_scaled <- scale(subset_clean)

```

```{r}
#Step 2
pca_subset <- prcomp(subset_scaled, center = TRUE, scale. = TRUE)

# Summary of explained variance
summary(pca_subset)

```
```{r}
pca_subset$rotation

```

## 37. Visualize employees in PCA-reduced 2D space grouped by PerformanceScore.
```{r}

# Assuming you already ran PCA on numeric features
pc_scores <- as.data.frame(pca_result$x[, 1:2])  # First 2 PCs

# Add PerformanceScore info
# Make sure we only include rows used in PCA (cleaned data)
performance_clean <- hr %>% 
  filter(if_all(where(is.numeric), ~ !is.na(.) & is.finite(.))) %>% 
  pull(PerformanceScore)

pc_scores$PerformanceScore <- performance_clean
colnames(pc_scores)[1:2] <- c("PC1", "PC2")

# Plot
ggplot(pc_scores, aes(x = PC1, y = PC2, color = PerformanceScore)) +
  geom_point(alpha = 0.7, size = 2) +
  labs(title = "PCA: Employees in 2D Space by Performance Score",
       x = "PC1",
       y = "PC2",
       color = "Performance Score") +
  theme_minimal()

```

## 38. Compare clustering before and after PCA using k-means on numeric data.
```{r}
#Step 1: Prepare numeric data (cleaned)
# Numeric features
numeric_data <- hr %>% select(where(is.numeric))

# Remove rows with NA or Inf
numeric_clean <- numeric_data %>% filter(if_all(everything(), ~ !is.na(.) & is.finite(.)))

# Standardize
numeric_scaled <- scale(numeric_clean)
```

```{r}
# Step 2: K-means on original numeric data
set.seed(123)
k <- 3  # choose number of clusters
km_original <- kmeans(numeric_scaled, centers = k, nstart = 25)

# Add cluster labels
cluster_orig <- km_original$cluster
```

```{r}
# Step 3: PCA for dimensionality reduction
pca_result <- prcomp(numeric_scaled, center = TRUE, scale. = TRUE)

# Use first 2 PCs
pc_scores <- as.data.frame(pca_result$x[, 1:2])
```

```{r}
#Step 4: K-means on PCA-reduced data
set.seed(123)
km_pca <- kmeans(pc_scores, centers = k, nstart = 25)
cluster_pca <- km_pca$cluster
pc_scores$Cluster <- as.factor(cluster_pca)
```

```{r}
# Step 5: Compare clusters visually
# Original data clustering (first 2 PCs for visualization)
pc_scores$Cluster_Orig <- as.factor(cluster_orig)

# Plot clusters on PCA space
ggplot(pc_scores, aes(x = PC1, y = PC2)) +
  geom_point(aes(color = Cluster_Orig), alpha = 0.6, size = 2) +
  labs(title = "K-means Clusters on Original Numeric Data (visualized on PCA space)",
       x = "PC1", y = "PC2", color = "Cluster") +
  theme_minimal()

# Plot clusters on PCA-reduced data
ggplot(pc_scores, aes(x = PC1, y = PC2, color = Cluster)) +
  geom_point(alpha = 0.6, size = 2) +
  labs(title = "K-means Clusters on PCA-Reduced Data (first 2 PCs)",
       x = "PC1", y = "PC2", color = "Cluster") +
  theme_minimal()

```

## 39. Plot loadings of salary, absences, and engagement on the first 2 PCs.
```{r}
# Select relevant loadings from PCA
loadings_subset <- data.frame(
  Variable = c("Salary", "Absences", "EngagementSurvey"),
  PC1 = pca_result$rotation[c("Salary", "Absences", "EngagementSurvey"), 1],
  PC2 = pca_result$rotation[c("Salary", "Absences", "EngagementSurvey"), 2]
)

# Plot loadings as arrows
ggplot(loadings_subset, aes(x = PC1, y = PC2, label = Variable)) +
  geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2),
               arrow = arrow(length = unit(0.3,"cm")), color = "steelblue", size = 1) +
  geom_text(aes(x = PC1*1.1, y = PC2*1.1), size = 5) +
  xlim(-1, 1) + ylim(-1, 1) +
  labs(title = "Loadings of Salary, Absences, and Engagement on PC1 and PC2",
       x = "PC1", y = "PC2") +
  theme_minimal() +
  coord_fixed()  # keep aspect ratio 1:1
```

## 40. Discuss when PCA is appropriate in HR analytics (e.g., reducing survey dimensions).

